# -----------------------------
# Application
# -----------------------------
spring.application.name=isa-backend
server.port=8081
# Za klaster: postavi u env APP_REPLICA_ID (npr. replica1, replica2)
app.replica.id=default

# -----------------------------
# Spring DataSource (PostgreSQL)
# -----------------------------
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://localhost:5432/isa
spring.datasource.username=postgres
spring.datasource.password=root

# -----------------------------
# JPA / Hibernate
# -----------------------------
spring.jpa.show-sql=true

# za razvoj: pravi tabele na startu, bri?e ih na stop
#spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.ddl-auto=create-drop
# PostgreSQL LOB fix
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Hibernate dialect za Postgres
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect


# Anja dodala: kontrola koliko veliki fajlovi se mogu dodati + dozvoljeno vreme za upload
spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=210MB
spring.mvc.async.request-timeout=30000

spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=isa.tim8.demo@gmail.com
spring.mail.password=pemw yiqp qtnl ghzp
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

app.frontend.base-url=http://localhost:4200

#ogranicenje za login
resilience4j.ratelimiter.instances.login.limitForPeriod=5
resilience4j.ratelimiter.instances.login.limitRefreshPeriod=1m
resilience4j.ratelimiter.instances.login.timeoutDuration=0

# Hibernate L2 cache
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory
spring.jpa.properties.hibernate.javax.cache.provider=org.ehcache.jsr107.EhcacheCachingProvider
spring.jpa.properties.hibernate.javax.cache.uri=classpath:ehcache.xml
spring.jpa.properties.hibernate.javax.cache.missing_cache_strategy=create

spring.cache.type=jcache
spring.cache.jcache.config=classpath:ehcache.xml

#spring.jpa.properties.hibernate.generate_statistics=true
#logging.level.org.hibernate.stat=DEBUG
#logging.level.org.hibernate.cache=DEBUG
#logging.level.org.springframework.cache.interceptor=TRACE


# Actuator / Health (klaster, load balancer)

management.endpoints.web.exposure.include=health,info, prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.health.show-components=always
management.health.db.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# RabbitMQ (Transcoding)

spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest

# Prometheus
management.metrics.enable.all=true

